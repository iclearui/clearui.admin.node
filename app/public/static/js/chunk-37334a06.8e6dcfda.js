(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37334a06","chunk-2d0e1f23"],{"50a6":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.view?a("htmb-edit",{attrs:{uid:e.uid},model:{value:e.view,callback:function(t){e.view=t},expression:"view"}}):a("a-card",{attrs:{bordered:!1}},[e.menu.buttons?a("c-button-group",{attrs:{slot:"title",buttons:e.menu.buttons.list},on:{click:e.click},slot:"title"}):e._e(),a("a-table",{attrs:{columns:e.table.columns,bordered:"",tableLayout:"fixed",rowKey:"_id",dataSource:e.table.data,size:"small",customRow:e.customRow,pagination:e.table.pagination,loading:e.loading},on:{change:e.onTableChange},scopedSlots:e._u([{key:"action",fn:function(t,r,i){return[a("a-icon",{attrs:{type:"eye"},on:{click:function(t){e.uid=r._id,e.view="view"}}})]}}],null,!1,3025543602)})],1)},i=[],n=(a("96cf"),a("1da1")),o=a("5530"),l=a("2f62"),s=a("7d33"),c={name:"htmb",components:{HtmbEdit:s["default"]},data:function(){return{uid:"",view:"",loading:!0,table:{pagination:{showSizeChanger:!0,showQuickJumper:!0,total:0},query:{order:"_id",limit:10,page:1,populate:"idFilePdf,idFileWord,idClass"},columns:[{title:"序号",align:"center",fixed:"left",width:60,customRender:function(e,t,a){return a+1}},{title:"模板分类",key:"idClass",align:"center",customRender:function(e,t,a){return t.idClass.className}},{title:"合同模板编码",dataIndex:"contractCode",key:"contractCode",align:"center"},{title:"合同模板名称",dataIndex:"contractName",key:"contractName",align:"center"},{title:"下载价格",dataIndex:"price",key:"price",align:"center"},{title:"预览文件",key:"idFilePdf",align:"center",customRender:function(e,t,a){return t.idFilePdf.fileName}},{title:"下载文件",key:"idFileWord",align:"center",customRender:function(e,t,a){return t.idFileWord.fileName}},{title:"备注",dataIndex:"memo",key:"memo",align:"center"},{title:"操作",align:"center",fixed:"right",width:100,key:"action",scopedSlots:{customRender:"action"}}],data:[]}}},created:function(){this.loadData()},computed:Object(o["a"])({},Object(l["c"])(["menu"])),watch:{view:function(e){e||(this.uid="",this.loadData())}},methods:{click:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:a.t0=e,a.next="create"===a.t0?3:6;break;case 3:return t.uid="",t.view="modify",a.abrupt("break",7);case 6:return a.abrupt("break",7);case 7:case"end":return a.stop()}}),a)})))()},customRow:function(e,t){var a=this;return{on:{dblclick:function(){a.uid=e._id,a.view="view"}}}},loadData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$helper.model("fxe_legal_htmb").get({params:e.table.query});case 3:a=t.sent,e.table.data=a.records,e.table.pagination.total=a.count,e.loading=!1;case 7:case"end":return t.stop()}}),t)})))()},editClose:function(){this.$refs.form.resetFields(),this.visible=!1},onTableChange:function(e,t,a){var r=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r.table.query.page=e.current,r.table.query.limit!==e.pageSize&&(r.table.query.limit=e.pageSize,r.table.query.page=1),a.field&&(i="ascend"===a.order?a.field:"-"+a.field,r.table.query.order!==i&&(r.table.query.order=i,r.table.query.page=1)),t.next=5,r.loadData();case 5:case"end":return t.stop()}}),t)})))()}}},d=c,u=a("2877"),m=Object(u["a"])(d,r,i,!1,null,"cdcf7430",null);t["default"]=m.exports},"7d33":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[e.menu.buttons?a("c-button-group",{attrs:{slot:"title",buttons:e.menu.buttons.edit,showSave:"view"!==e.value,showBack:""},on:{click:e.click},slot:"title"}):e._e(),a("a-form-model",{ref:"form",attrs:{labelAlign:"left",model:e.form.model,rules:e.form.rules,"label-col":e.form.labelCol,"wrapper-col":e.form.wrapperCol,disabled:"view"===e.value}},[a("a-row",{attrs:{gutter:12}},[a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"模板分类"}},[a("c-tree-select",{attrs:{model:"fxe_legal_htmb_class",title:"className",placeholder:"模板分类",disabled:"view"===e.value},model:{value:e.form.model.idClass,callback:function(t){e.$set(e.form.model,"idClass",t)},expression:"form.model.idClass"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"模板编码"}},[a("a-input",{attrs:{placeholder:"模板编码",disabled:"view"===e.value},model:{value:e.form.model.contractCode,callback:function(t){e.$set(e.form.model,"contractCode",t)},expression:"form.model.contractCode"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"模板名称"}},[a("a-input",{attrs:{placeholder:"模板名称",disabled:"view"===e.value},model:{value:e.form.model.contractName,callback:function(t){e.$set(e.form.model,"contractName",t)},expression:"form.model.contractName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"下载价格"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1,placeholder:"下载价格",disabled:"view"===e.value},model:{value:e.form.model.price,callback:function(t){e.$set(e.form.model,"price",t)},expression:"form.model.price"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"预览文件"}},[a("a-upload",{attrs:{name:"pdf",accept:".pdf",multiple:!1,"file-list":e.fileListPdf,action:e.$url.file.upload,disabled:"view"===e.value},on:{change:e.changePdf}},[e.form.model.idFilePdf?e._e():a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传 ")],1)],1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"下载文件"}},[a("a-upload",{attrs:{name:"word",accept:".doc,.docx",multiple:!1,"file-list":e.fileListWord,action:e.$url.file.upload,disabled:"view"===e.value},on:{change:e.changeWord}},[e.form.model.idFileWord?e._e():a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传 ")],1)],1)],1)],1),a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{label:"简介"}},[a("a-textarea",{attrs:{placeholder:"简介","allow-clear":"",disabled:"view"===e.value},model:{value:e.form.model.desc,callback:function(t){e.$set(e.form.model,"desc",t)},expression:"form.model.desc"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"备注"}},[a("a-input",{attrs:{placeholder:"备注",disabled:"view"===e.value},model:{value:e.form.model.memo,callback:function(t){e.$set(e.form.model,"memo",t)},expression:"form.model.memo"}})],1)],1)],1)],1)],1)},i=[],n=(a("b0c0"),a("96cf"),a("1da1")),o=a("5530"),l=a("2f62"),s={name:"edit",props:{value:{type:String},uid:{type:[String,Object]}},data:function(){return{fileListPdf:[],fileListWord:[],form:{labelCol:{span:5},wrapperCol:{span:19},model:{},rules:{type:[{required:!0,message:"必填",trigger:"blur"}]}}}},computed:Object(o["a"])({},Object(l["c"])(["menu"])),watch:{value:function(e){this.$refs.form.resetFields(),"create"!==e&&this.form.model._id&&this.loadData(this.form.model._id)},uid:function(e){e&&this.loadData(e)}},mounted:function(){this.uid&&(this.$refs.form.resetFields(),this.loadData(this.uid))},methods:{click:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:a.t0=e,a.next="modify"===a.t0?3:"remove"===a.t0?5:"back"===a.t0?8:"conserve"===a.t0?10:"cancel"===a.t0?13:18;break;case 3:return t.$emit("input","modify"),a.abrupt("break",19);case 5:return a.next=7,t.remove(t.form.model);case 7:return a.abrupt("break",19);case 8:return t.backList(),a.abrupt("break",19);case 10:return a.next=12,t.conserve(t.form.model);case 12:return a.abrupt("break",19);case 13:if(!t.uid){a.next=16;break}return t.$emit("input","view"),a.abrupt("return");case 16:return t.backList(),a.abrupt("break",19);case 18:return a.abrupt("break",19);case 19:case"end":return a.stop()}}),a)})))()},backList:function(){this.form.model={},this.$emit("input","")},changePdf:function(e){switch(e.file.status){case"uploading":this.fileListPdf=[e.file];break;case"removed":delete this.form.model.idFilePdf,this.fileListPdf=[];break;case"error":this.$message.error("".concat(e.file.name," 文件上传失败！"));break;case"done":this.form.model.idFilePdf=e.file.response.records[0]._id,this.fileListPdf[0].url=this.$url.file.preview+e.file.response.records[0]._id,this.$message.success("".concat(e.file.name," 文件上传成功！"));break;default:break}},changeWord:function(e){switch(e.file.status){case"uploading":this.fileListWord=[e.file];break;case"removed":delete this.form.model.idFileWord,this.fileListWord=[];break;case"error":this.$message.error("".concat(e.file.name," 文件上传失败！"));break;case"done":this.form.model.idFileWord=e.file.response.records[0]._id,this.fileListWord[0].url=this.$url.file.preview+e.file.response.records[0]._id,this.$message.success("".concat(e.file.name," 文件上传成功！"));break;default:break}},loadData:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$helper.model("fxe_legal_htmb").getByID(e,{params:{populate:"idFilePdf,idFileWord"}});case 2:t.form.model=a.sent.records[0],t.fileListPdf=[{uid:"1",status:"done",name:t.form.model.idFilePdf.fileName,url:t.$url.file.preview+t.form.model.idFilePdf._id}],t.fileListWord=[{uid:"1",status:"done",name:t.form.model.idFileWord.fileName,url:t.$url.file.preview+t.form.model.idFileWord._id}];case 5:case"end":return a.stop()}}),a)})))()},conserve:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$refs.form.validate(function(){var a=Object(n["a"])(regeneratorRuntime.mark((function a(r){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!r){a.next=17;break}if(!e._id){a.next=8;break}return a.next=4,t.$helper.model("fxe_legal_htmb").put(e._id,e);case 4:return a.next=6,t.loadData(e._id);case 6:a.next=14;break;case 8:return a.t0=t,a.next=11,t.$helper.model("fxe_legal_htmb").post(e);case 11:return a.t1=a.sent.records._id,a.next=14,a.t0.loadData.call(a.t0,a.t1);case 14:t.$emit("input","view"),a.next=20;break;case 17:t.$message.error("数据有误，请检查后重新提交！！！"),t.loading=!0,setTimeout((function(){t.loading=!1}),1e3);case 20:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}());case 1:case"end":return a.stop()}}),a)})))()},remove:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$helper.model("fxe_legal_htmb").delete(e._id);case 2:t.$message.success("数据删除成功"),t.backList();case 4:case"end":return a.stop()}}),a)})))()}}},c=s,d=a("2877"),u=Object(d["a"])(c,r,i,!1,null,"141a29a8",null);t["default"]=u.exports}}]);