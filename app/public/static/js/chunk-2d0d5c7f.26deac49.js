(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d5c7f"],{"706f":function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("a-card",[e.menu.buttons?t("c-button-group",{attrs:{slot:"title",buttons:e.menu.buttons.edit,showSave:"view"!==e.value,showBack:""},on:{click:e.click},slot:"title"}):e._e(),t("a-form-model",{ref:"form",attrs:{labelAlign:"left",model:e.form.model,rules:e.form.rules,"label-col":e.form.labelCol,"wrapper-col":e.form.wrapperCol,disabled:"view"===e.value}},[t("a-row",{attrs:{gutter:12}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"标识编码"}},[t("a-input",{attrs:{placeholder:"标识编码",disabled:"view"===e.value},model:{value:e.form.model.code,callback:function(r){e.$set(e.form.model,"code",r)},expression:"form.model.code"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"选择图片"}},[t("a-upload",{attrs:{name:"file",multiple:!1,"file-list":e.fileList,action:e.$url.file.upload,"before-upload":e.beforeUpload,disabled:"view"===e.value},on:{change:e.handleChange}},[e.form.model.idFile?e._e():t("a-button",[t("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传 ")],1)],1)],1)],1),t("a-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[e.imageUrl?t("img",{staticStyle:{width:"600px",height:"400px"},attrs:{src:e.imageUrl,alt:"avatar"}}):e._e()])],1)],1)],1)},n=[],i=(t("b0c0"),t("96cf"),t("1da1")),o=t("5530"),s=t("2f62"),l={name:"edit",props:{value:{type:String},uid:{type:[String,Object]}},data:function(){return{imageUrl:"",fileList:[],form:{labelCol:{span:5},wrapperCol:{span:19},model:{familyInfo:[{}],workInfo:[{}]},rules:{type:[{required:!0,message:"必填",trigger:"blur"}]}}}},computed:Object(o["a"])({},Object(s["c"])(["menu"])),watch:{value:function(e){this.$refs.form.resetFields(),"create"!==e&&this.form.model._id&&this.loadData(this.form.model._id)},uid:function(e){e&&this.loadData(e)}},mounted:function(){this.uid&&(this.$refs.form.resetFields(),this.loadData(this.uid))},methods:{click:function(e){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.t0=e,t.next="modify"===t.t0?3:"remove"===t.t0?5:"back"===t.t0?8:"conserve"===t.t0?10:"cancel"===t.t0?13:18;break;case 3:return r.$emit("input","modify"),t.abrupt("break",19);case 5:return t.next=7,r.remove(r.form.model);case 7:return t.abrupt("break",19);case 8:return r.backList(),t.abrupt("break",19);case 10:return t.next=12,r.conserve(r.form.model);case 12:return t.abrupt("break",19);case 13:if(!r.uid){t.next=16;break}return r.$emit("input","view"),t.abrupt("return");case 16:return r.backList(),t.abrupt("break",19);case 18:return t.abrupt("break",19);case 19:case"end":return t.stop()}}),t)})))()},backList:function(){this.form.model={},this.$emit("input","")},handleChange:function(e){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.t0=e.file.status,t.next="uploading"===t.t0?3:"removed"===t.t0?5:"error"===t.t0?9:"done"===t.t0?11:16;break;case 3:return r.fileList=[e.file],t.abrupt("break",17);case 5:return delete r.form.model.idFile,r.fileList=[],r.imageUrl="",t.abrupt("break",17);case 9:return r.$message.error("".concat(e.file.name," 文件上传失败！")),t.abrupt("break",17);case 11:return r.form.model.idFile=e.file.response.records[0]._id,e.file.url=r.$url.file.preview+e.file.response.records[0]._id,r.imageUrl=r.$url.file.preview+e.file.response.records[0]._id,r.$message.success("".concat(e.file.name," 文件上传成功！")),t.abrupt("break",17);case 16:return t.abrupt("break",17);case 17:case"end":return t.stop()}}),t)})))()},beforeUpload:function(e){var r="image/jpeg"===e.type||"image/png"===e.type;r||this.$message.error("只能上传图片!");var t=e.size/1024/1024<2;return t||this.$message.error("请上传小于2MB的文件!"),r&&t},loadData:function(e){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.$helper.model("fxe_carousel").getByID(e,{params:{populate:"idFile"}});case 2:r.form.model=t.sent.records[0],r.imageUrl=r.$url.file.preview+r.form.model.idFile._id,r.fileList=[{uid:"1",status:"done",name:r.form.model.idFile.fileName,url:r.$url.file.preview+r.form.model.idFile._id}];case 5:case"end":return t.stop()}}),t)})))()},conserve:function(e){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r.$refs.form.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=17;break}if(!e._id){t.next=8;break}return t.next=4,r.$helper.model("fxe_carousel").put(e._id,e);case 4:return t.next=6,r.loadData(e._id);case 6:t.next=14;break;case 8:return t.t0=r,t.next=11,r.$helper.model("fxe_carousel").post(e);case 11:return t.t1=t.sent.records._id,t.next=14,t.t0.loadData.call(t.t0,t.t1);case 14:r.$emit("input","view"),t.next=20;break;case 17:r.$message.error("数据有误，请检查后重新提交！！！"),r.loading=!0,setTimeout((function(){r.loading=!1}),1e3);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},remove:function(e){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r.$helper.model("fxe_carousel").delete(e._id);case 2:r.$message.success("数据删除成功"),r.backList();case 4:case"end":return t.stop()}}),t)})))()}}},u=l,c=t("2877"),m=Object(c["a"])(u,a,n,!1,null,"1066ee56",null);r["default"]=m.exports}}]);