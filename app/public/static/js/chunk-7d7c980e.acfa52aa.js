(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d7c980e","chunk-2d0aeb1d"],{"0ac9":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-card",[e.menu.buttons?r("c-button-group",{attrs:{slot:"title",buttons:e.menu.buttons.edit,showSave:"view"!==e.value,showBack:""},on:{click:e.click},slot:"title"}):e._e(),r("a-form-model",{ref:"form",attrs:{labelAlign:"left",model:e.form.model,rules:e.form.rules,"label-col":e.form.labelCol,"wrapper-col":e.form.wrapperCol,disabled:"view"===e.value}},[r("a-row",{attrs:{gutter:12}},[r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"标识编码"}},[r("a-input",{attrs:{placeholder:"标识编码",disabled:"view"===e.value},model:{value:e.form.model.code,callback:function(t){e.$set(e.form.model,"code",t)},expression:"form.model.code"}})],1)],1),r("a-col",{attrs:{span:12}},[r("a-form-model-item",{attrs:{label:"业务名称"}},[r("a-input",{attrs:{placeholder:"业务名称",disabled:"view"===e.value},model:{value:e.form.model.name,callback:function(t){e.$set(e.form.model,"name",t)},expression:"form.model.name"}})],1)],1),r("a-col",{attrs:{span:24}},[r("a-form-model-item",{attrs:{label:"问题描述"}},[r("a-textarea",{attrs:{placeholder:"问题描述","allow-clear":"",disabled:"view"===e.value},model:{value:e.form.model.desc,callback:function(t){e.$set(e.form.model,"desc",t)},expression:"form.model.desc"}})],1)],1),r("a-col",{attrs:{span:24}},["modify"===e.value?r("a-upload-dragger",{attrs:{name:"file",multiple:!0,action:e.$url.file.upload,"default-file-list":e.defaultFileList,disabled:"view"===e.value},on:{change:e.handleChange}},[r("p",{staticClass:"ant-upload-drag-icon"},[r("a-icon",{attrs:{type:"inbox"}})],1),r("p",{staticClass:"ant-upload-text"},[e._v(" 单击或拖动文件到此区域以上传 ")])]):r("a-form-model-item",{attrs:{label:"附件下载"}},e._l(e.defaultFileList,(function(t){return r("a",{key:t.uid,attrs:{href:t.url}},[e._v(" "+e._s(t.name)+" ")])})),0)],1)],1)],1)],1)},n=[],i=(r("c740"),r("d81d"),r("a434"),r("b0c0"),r("b85c")),o=(r("96cf"),r("1da1")),l=r("5530"),s=r("2f62"),u={name:"edit",props:{value:{type:String},uid:{type:[String,Object]}},data:function(){return{defaultFileList:[],form:{labelCol:{span:5},wrapperCol:{span:19},model:{idFiles:[]},rules:{type:[{required:!0,message:"必填",trigger:"blur"}]}}}},computed:Object(l["a"])({},Object(s["c"])(["menu"])),watch:{value:function(e){this.$refs.form.resetFields(),"create"!==e&&this.form.model._id&&this.loadData(this.form.model._id)},uid:function(e){e&&this.loadData(e)}},mounted:function(){this.uid&&(this.$refs.form.resetFields(),this.loadData(this.uid))},methods:{click:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:r.t0=e,r.next="modify"===r.t0?3:"remove"===r.t0?5:"back"===r.t0?8:"conserve"===r.t0?10:"cancel"===r.t0?13:18;break;case 3:return t.$emit("input","modify"),r.abrupt("break",19);case 5:return r.next=7,t.remove(t.form.model);case 7:return r.abrupt("break",19);case 8:return t.backList(),r.abrupt("break",19);case 10:return r.next=12,t.conserve(t.form.model);case 12:return r.abrupt("break",19);case 13:if(!t.uid){r.next=16;break}return t.$emit("input","view"),r.abrupt("return");case 16:return t.backList(),r.abrupt("break",19);case 18:return r.abrupt("break",19);case 19:case"end":return r.stop()}}),r)})))()},backList:function(){this.form.model={},this.$emit("input","")},handleChange:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:r.t0=e.file.status,r.next="uploading"===r.t0?3:"removed"===r.t0?4:"error"===r.t0?6:"done"===r.t0?8:12;break;case 3:return r.abrupt("break",13);case 4:return t.form.model.idFiles.splice(t.form.model.idFiles.map((function(e){return e.idFile})).findIndex((function(t){return t===e.file.response?e.file.response.records[0]._id:e.file.uid})),1),r.abrupt("break",13);case 6:return t.$message.error("".concat(e.file.name," 文件上传失败！")),r.abrupt("break",13);case 8:return e.file.url=t.$url.file.preview+e.file.response.records[0]._id,t.form.model.idFiles.push({idFile:e.file.response.records[0]._id}),t.$message.success("".concat(e.file.name," 文件上传成功！")),r.abrupt("break",13);case 12:return r.abrupt("break",13);case 13:a=Object(i["a"])(e.fileList);try{for(a.s();!(n=a.n()).done;)o=n.value,o.response&&(o.url=t.$url.file.preview+o.response.records[0]._id)}catch(l){a.e(l)}finally{a.f()}case 15:case"end":return r.stop()}}),r)})))()},loadData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$helper.model("fxe_advise").getByID(e,{params:{populate:"idFiles.idFile"}});case 2:t.form.model=r.sent.records[0],t.defaultFileList=[],a=Object(i["a"])(t.form.model.idFiles);try{for(a.s();!(n=a.n()).done;)o=n.value,t.defaultFileList.push({uid:o.idFile._id,status:"done",name:o.idFile.fileName,url:t.$url.file.preview+o.idFile._id})}catch(l){a.e(l)}finally{a.f()}case 6:case"end":return r.stop()}}),r)})))()},conserve:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$refs.form.validate(function(){var r=Object(o["a"])(regeneratorRuntime.mark((function r(a){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!a){r.next=17;break}if(!e._id){r.next=8;break}return r.next=4,t.$helper.model("fxe_advise").put(e._id,e);case 4:return r.next=6,t.loadData(e._id);case 6:r.next=14;break;case 8:return r.t0=t,r.next=11,t.$helper.model("fxe_advise").post(e);case 11:return r.t1=r.sent.records._id,r.next=14,r.t0.loadData.call(r.t0,r.t1);case 14:t.$emit("input","view"),r.next=20;break;case 17:t.$message.error("数据有误，请检查后重新提交！！！"),t.loading=!0,setTimeout((function(){t.loading=!1}),1e3);case 20:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());case 1:case"end":return r.stop()}}),r)})))()},remove:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$helper.model("fxe_advise").delete(e._id);case 2:t.$message.success("数据删除成功"),t.backList();case 4:case"end":return r.stop()}}),r)})))()}}},c=u,d=r("2877"),m=Object(d["a"])(c,a,n,!1,null,"aedfb17c",null);t["default"]=m.exports},"3a8a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.view?r("advise-edit",{attrs:{uid:e.uid},model:{value:e.view,callback:function(t){e.view=t},expression:"view"}}):r("a-card",{attrs:{bordered:!1}},[e.menu.buttons?r("c-button-group",{attrs:{slot:"title",buttons:e.menu.buttons.list},on:{click:e.click},slot:"title"}):e._e(),r("a-table",{attrs:{columns:e.table.columns,bordered:"",tableLayout:"fixed",rowKey:"_id",dataSource:e.table.data,size:"small",customRow:e.customRow,pagination:e.table.pagination,loading:e.loading},on:{change:e.onTableChange},scopedSlots:e._u([{key:"action",fn:function(t,a,n){return[r("a-icon",{attrs:{type:"eye"},on:{click:function(t){e.uid=a._id,e.view="view"}}})]}},{key:"fileList",fn:function(t,a,n){return e._l(a.idFiles,(function(t){return r("a",{key:t.idFile._id,attrs:{href:e.$url.file.preview+t.idFile._id}},[e._v(" "+e._s(t.idFile.fileName)+" ")])}))}}],null,!1,3510177686)})],1)},n=[],i=(r("96cf"),r("1da1")),o=r("5530"),l=r("2f62"),s=r("0ac9"),u={name:"mbdd",components:{AdviseEdit:s["default"]},data:function(){return{uid:"",view:"",loading:!0,table:{pagination:{showSizeChanger:!0,showQuickJumper:!0,total:0},query:{order:"_id",limit:10,page:1,populate:"idFiles.idFile"},columns:[{title:"序号",align:"center",fixed:"left",width:60,customRender:function(e,t,r){return r+1}},{title:"标识编码",dataIndex:"code",key:"code",align:"center"},{title:"问题描述",dataIndex:"desc",key:"desc",align:"center"},{title:"操作",align:"center",fixed:"right",width:100,key:"action",scopedSlots:{customRender:"action"}}],data:[]}}},created:function(){this.loadData()},computed:Object(o["a"])({},Object(l["c"])(["menu"])),watch:{view:function(e){e||(this.uid="",this.loadData())}},methods:{click:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:r.t0=e,r.next="create"===r.t0?3:6;break;case 3:return t.uid="",t.view="modify",r.abrupt("break",7);case 6:return r.abrupt("break",7);case 7:case"end":return r.stop()}}),r)})))()},customRow:function(e,t){var r=this;return{on:{dblclick:function(){r.uid=e._id,r.view="view"}}}},loadData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$helper.model("fxe_advise").get({params:e.table.query});case 3:r=t.sent,e.table.data=r.records,e.table.pagination.total=r.count,e.loading=!1;case 7:case"end":return t.stop()}}),t)})))()},editClose:function(){this.$refs.form.resetFields(),this.visible=!1},onTableChange:function(e,t,r){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a.table.query.page=e.current,a.table.query.limit!==e.pageSize&&(a.table.query.limit=e.pageSize,a.table.query.page=1),r.field&&(n="ascend"===r.order?r.field:"-"+r.field,a.table.query.order!==n&&(a.table.query.order=n,a.table.query.page=1)),t.next=5,a.loadData();case 5:case"end":return t.stop()}}),t)})))()}}},c=u,d=r("2877"),m=Object(d["a"])(c,a,n,!1,null,"62da1a6b",null);t["default"]=m.exports}}]);